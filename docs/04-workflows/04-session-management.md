<!-- last_updated: 2026-02-11 -->

# 17. 세션 관리와 이어서 작업하기

> 세션 저장, 재개, 포크 등 세션 관리 전략을 다룹니다.

---

## 세션 자동 저장

### 저장 위치와 구조

모든 대화는 `~/.claude/sessions/`에 자동 저장됩니다:

```
~/.claude/sessions/
├── <session-id>.json           # 대화 이력
├── <session-id>-state.json     # 세션 상태
└── .../checkpoints/            # 파일 스냅샷
```

### 저장되는 정보

| 항목 | 설명 |
|------|------|
| **대화 이력** | 모든 프롬프트와 응답 |
| **도구 사용 기록** | 명령어 실행, 파일 편집 내역 |
| **파일 스냅샷** | 체크포인트용 파일 상태 |
| **모델 설정** | 사용 중인 모델과 설정 |
| **Git 브랜치** | 세션이 활동한 브랜치 정보 |

### 보존 기간

- 세션: 기본 30일 후 삭제
- 체크포인트: 세션과 함께 삭제
- 수동 삭제: `/clear`로 현재 세션 초기화

---

## `--continue` — 마지막 세션 이어가기

### 기본 사용법

```bash
# 현재 디렉토리의 가장 최근 세션을 재개
claude --continue
```

### Headless 모드와 결합

```bash
# 이전 세션에 추가 작업 요청
claude --continue -p "타입 에러를 확인해줘"
```

### 포크와 결합

```bash
# 이전 세션을 포크하여 새 접근 시도
claude --continue --fork-session
```

### 동작 방식

- 현재 디렉토리에서 가장 최근 세션을 선택
- 전체 대화 이력이 복원됨
- 세션 범위 권한은 초기화됨 (다시 승인 필요)
- 동일 모델과 설정 사용
- 새 메시지가 기존 세션에 추가됨

### 사용 시점

- 작업 중 터미널을 닫았다가 다시 여는 경우
- 인터럽트 후 같은 작업을 계속할 때
- 같은 디렉토리, 같은 브랜치에서 작업할 때

---

## `--resume` — 특정 세션 재개

### 이름으로 재개

```bash
claude --resume auth-refactor
```

### ID로 재개

```bash
claude --resume 550e8400-e29b-41d4-a716-446655440000
```

### 대화형 세션 선택기

```bash
# 인자 없이 실행하면 선택기가 열림
claude --resume
```

### 세션 선택기 조작법

| 키 | 동작 |
|:--:|------|
| `↑` / `↓` | 세션 탐색 |
| `→` / `←` | 그룹 열기/닫기 |
| `Enter` | 세션 선택 |
| `P` | 내용 미리보기 |
| `R` | 세션 이름 변경 |
| `/` | 검색/필터 |
| `A` | 모든 프로젝트 표시 토글 |
| `B` | Git 브랜치별 필터 |
| `Esc` | 닫기 |

### 선택기에서 표시되는 정보

- 세션 이름 또는 첫 프롬프트
- 마지막 활동 시간
- 메시지 수
- Git 브랜치
- 포크된 세션은 그룹으로 묶임

---

## `/rename` — 세션 이름 지정

### 사용법

```
> /rename oauth-migration
```

### 좋은 이름 패턴

```
/rename payment-integration
/rename debugging-memory-leak
/rename auth-refactor
/rename database-migration-v2
```

### 워크플로우

```bash
# 작업 시작 시 이름 지정
claude
> /rename feature-user-dashboard

# 나중에 이름으로 재개
claude --resume feature-user-dashboard
```

---

## 세션 포크 (`--fork-session`)

### 개념

세션 포크는 현재 세션의 **복사본**을 만들어 독립적으로 진행하는 것입니다. 원본 세션은 변경되지 않습니다.

### 사용법

```bash
# 현재 세션을 포크
claude --continue --fork-session

# 특정 세션을 포크
claude --resume auth-refactor --fork-session
```

### 동작 방식

```
원본 세션 (auth-refactor)
├── 메시지 1~10 (공통 이력)
│
├─→ 원본 계속: 접근법 A로 진행
│
└─→ 포크: 접근법 B로 진행 (독립적)
```

- 새 세션 ID가 생성됨
- 포크 시점까지의 대화 이력이 복제됨
- 원본 세션은 그대로 유지
- 양쪽 세션이 완전히 독립적
- 세션 범위 권한은 초기화

### 활용 시나리오

| 시나리오 | 설명 |
|---------|------|
| **접근법 비교** | A/B 두 가지 구현 방법을 각각 시도 |
| **위험한 변경 전 백업** | 포크 후 위험한 변경을 시도 |
| **병렬 실험** | 다른 전략을 동시에 탐색 |

### 세션 포크 vs Git 브랜치

```
세션 포크: 같은 코드 상태에서 다른 AI 접근법을 시도
Git 브랜치: 코드 상태를 보존하고 다른 구현 방향으로 진행
```

---

## 체크포인트와 되돌리기

### `/rewind` 명령어

```
Esc + Esc    # 키보드 단축키
/rewind      # 명령어
```

### 되돌리기 옵션

1. **코드와 대화 모두 복원** — 파일과 채팅을 이전 상태로
2. **대화만 복원** — 현재 코드 유지, 채팅만 되돌림
3. **코드만 복원** — 파일만 이전 상태로, 대화 유지
4. **여기서부터 요약** — 선택 시점 이후 메시지를 압축
5. **취소** — 메뉴 닫기

### 활용 예

```
# 여러 편집을 했는데 다른 접근이 더 나을 것 같을 때
Esc + Esc
→ 5턴 전 메시지 선택
→ "코드와 대화 모두 복원"
→ 새로운 접근으로 다시 프롬프트

# 컨텍스트가 많이 쌓였을 때
Esc + Esc
→ 적절한 시점 선택
→ "여기서부터 요약"
→ 이전 메시지 유지, 이후 메시지 압축
```

---

## `/teleport` — 웹에서 터미널로

### 개념

claude.ai에서 시작한 세션을 로컬 터미널에서 이어서 작업할 수 있습니다.

### 사용법

```bash
# CLI로 시작
claude --teleport

# 세션 중에
> /teleport
```

### 워크플로우

1. claude.ai에서 세션 생성/작업
2. 로컬 도구가 필요해짐 (git, bash 등)
3. 터미널에서 `claude --teleport` 실행
4. 웹 세션 선택
5. 전체 대화 이력과 함께 로컬에서 계속
6. 터미널의 모든 도구 사용 가능

### 요구사항

- Claude Opus 이상 구독 필요
- 동일 계정으로 로그인

---

## 컨텍스트 관리

### `/compact` — 대화 압축

```
> /compact

# 특정 주제에 집중하여 압축
> /compact API 변경 사항에 집중해줘
```

### 자동 압축

Claude는 컨텍스트 한도에 근접하면 **자동으로 압축**합니다:

- 중요한 코드, 결정 사항, 패턴은 보존
- 장황한 디버깅 과정이나 탐색 내용은 요약
- 초반 컨텍스트는 기본적으로 유지

### CLAUDE.md에서 압축 지침

```markdown
## 압축 시 보존할 내용
- 수정된 파일의 전체 목록
- 모든 테스트 명령어
- 핵심 아키텍처 결정 사항
- 인증 흐름 변경 내역
```

### 컨텍스트 모니터링

```
> /context
# 컨텍스트 사용량의 시각적 그리드 표시
```

### 컨텍스트 절약 팁

1. 무관한 작업 사이에 `/clear` 사용 (완전 초기화)
2. `/compact`로 대화 요약
3. 조사 작업은 서브에이전트에 위임 (별도 컨텍스트)
4. 스킬은 온디맨드 로딩 (`disable-model-invocation: true`)
5. CLAUDE.md는 필수 정보만 포함

---

## 세션 내보내기와 공유

### `/export`

```
> /export
# 대화 이력을 마크다운으로 내보내기
```

세션 이력을 외부에 공유하거나 기록으로 보관할 때 사용합니다.

### `/stash` 와 `/pop`

```
> /stash
# 현재 입력 중인 내용을 임시 저장

> /pop
# 저장된 내용을 복원
```

---

## 세션 전략

### 작업 단위별 세션

```bash
# 기능별로 별도 세션
claude
> /rename feature-auth
> (인증 관련 작업)

claude
> /rename fix-payment-bug
> (결제 버그 수정)
```

### 장기 프로젝트 세션

```bash
# 큰 프로젝트는 하나의 세션에서 지속
claude --resume project-v2-migration
> 어디까지 했었지?
> 다음 단계로 진행해줘
```

### 팀 워크플로우

```bash
# 공유 태스크 리스트로 협업
export CLAUDE_CODE_TASK_LIST_ID=my-project

# 세션 A: 프론트엔드
claude
> 대시보드 컴포넌트 구현

# 세션 B: 백엔드
claude
> API 엔드포인트 구현
```

---

## 요약

| 주제 | 핵심 포인트 |
|------|------------|
| **자동 저장** | `~/.claude/sessions/`에 자동 저장, 30일 보존 |
| **`--continue`** | 현재 디렉토리의 최근 세션 재개 |
| **`--resume`** | 이름/ID로 특정 세션 재개, 선택기 지원 |
| **`/rename`** | 세션에 설명적 이름 부여 |
| **포크** | `--fork-session`으로 세션 복사, 독립적 진행 |
| **`/rewind`** | `Esc+Esc`로 이전 체크포인트 복원 |
| **`/teleport`** | 웹 세션을 터미널로 이전 |
| **`/compact`** | 대화 압축, 자동 압축도 지원 |
| **`/context`** | 컨텍스트 사용량 모니터링 |

---

## 다음 챕터

[18장: Headless 모드와 자동화](05-headless-mode.md)에서 비대화형 모드로 스크립트와 CI/CD에서 활용하는 방법을 배웁니다.
