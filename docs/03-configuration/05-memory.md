<!-- last_updated: 2026-02-11 -->

# 13. 메모리 시스템

> Claude Code의 자동 메모리와 수동 메모리 관리, 세션 간 지식 유지 방법을 다룹니다.

---

## 메모리 시스템 개요

Claude Code의 메모리 시스템은 **세션 간에 지식을 유지**하는 메커니즘입니다. 세션이 종료되어도 중요한 패턴, 발견 사항, 선호도가 다음 세션에 자동으로 로드됩니다.

메모리는 두 가지 유형이 있습니다:

| 유형 | 생성 주체 | 목적 |
|------|-----------|------|
| **자동 메모리** (Auto Memory) | Claude가 자동으로 | 작업 중 발견한 패턴, 솔루션, 인사이트 기록 |
| **수동 메모리** (CLAUDE.md 등) | 사용자가 직접 | 프로젝트 지침, 코딩 규칙, 빌드 명령어 |

---

## 자동 메모리 (Auto Memory)

### 작동 원리

Claude는 세션 중에 유용한 정보를 발견하면 **자동으로 메모리 파일에 기록**합니다:

```
세션 N:
  사용자: "이 캐시 무효화 버그를 고쳐줘"
  Claude: [조사 → 원인 발견 → 수정 → 메모리에 기록]

세션 N+1:
  Claude: (자동 로드) "이 프로젝트에서 Redis 캐시 무효화는
           updatePermissions() 후 명시적으로 호출해야 합니다"
```

### 메모리 파일 위치

```
~/.claude/projects/<project-hash>/memory/
├── MEMORY.md              # 인덱스 (첫 200줄만 자동 로드)
├── debugging.md           # 디버깅 관련 메모
├── api-conventions.md     # API 설계 결정
├── patterns.md            # 발견된 패턴
└── ...                    # 주제별 파일
```

**프로젝트 해시 결정 방식**:
- Git 저장소 루트를 기준으로 해시 생성
- 같은 저장소의 하위 디렉토리들은 동일한 메모리를 공유
- Git worktree는 별도 메모리 디렉토리
- Git 저장소 밖에서는 작업 디렉토리를 기준으로 생성

### MEMORY.md의 역할

`MEMORY.md`는 메모리의 **인덱스이자 진입점**입니다:

- 세션 시작 시 **처음 200줄만** 자동 로드됩니다
- 간결한 요약과 주제 파일 참조를 포함합니다
- 200줄을 초과하는 내용은 로드되지 않으므로, 상세 내용은 별도 파일로 분리합니다

```markdown
# 프로젝트 메모리

## 빠른 참조
- **주요 언어**: TypeScript
- **프레임워크**: Next.js 14
- **테스트**: Jest
- **주의 사항**: Redis 캐시는 사용자 업데이트 후 수동 무효화 필요

## 주제별 메모
- 디버깅: @debugging.md
- API 규칙: @api-conventions.md
- 패턴: @patterns.md
```

주제 파일들은 Claude가 **필요할 때 온디맨드로** 읽습니다.

---

## `/memory` 커맨드

```
> /memory
```

메모리 파일을 직접 편집할 수 있는 인터페이스를 엽니다:

1. 메모리 파일 목록이 표시됩니다
2. 편집할 파일을 선택합니다
3. 시스템 기본 에디터에서 파일이 열립니다
4. 수정 후 저장하면 즉시 반영됩니다

### 활용 예

```
> /memory
# MEMORY.md를 선택하여 인덱스 정리

> /memory
# debugging.md를 선택하여 디버깅 메모 추가
```

---

## 무엇을 메모리에 저장할 것인가

### 저장하기 좋은 것

| 분류 | 예시 |
|------|------|
| **디버깅 인사이트** | 반복되는 에러의 원인과 해결법 |
| **아키텍처 메모** | 모듈 간 관계, 데이터 흐름 |
| **발견된 패턴** | 프로젝트 고유의 코딩 패턴 |
| **주요 커맨드** | 자주 쓰는 빌드/배포 명령어 |
| **API 동작** | 엔드포인트의 특이한 동작 |
| **성능 포인트** | 병목 지점과 최적화 방법 |
| **팀 결정** | 아키텍처 결정과 그 이유 |

### 저장하면 안 되는 것

| 분류 | 이유 |
|------|------|
| **민감한 데이터** (API 키, 비밀번호) | 환경 변수를 사용하세요 |
| **큰 코드 조각** | 파일 경로를 참조하세요 |
| **변경 가능한 절대 경로** | 상대 참조를 사용하세요 |
| **임시 워크어라운드** | 해결되면 삭제하세요 |
| **검증되지 않은 추측** | 확인된 사실만 기록하세요 |

### 좋은 메모리 항목 예시

```markdown
## Redis 캐시 무효화 이슈

### 문제
사용자 권한 업데이트 시 Redis 캐시가 무효화되지 않아
이전 권한이 계속 적용됨

### 해결
updatePermissions() 후 cache.invalidate() 명시적 호출
키 형식: `user:{id}:permissions`

### 관련 파일
- src/services/user-permissions.ts (45줄)
- tests/user-permissions.test.ts

### 기억할 점
캐시 무효화는 응답 반환 전에 실행해야 함 (후가 아님)
```

---

## 메모리 vs CLAUDE.md — 선택 기준

```
정보가 "어떻게 해야 하는가"에 대한 것인가?
├─ 예 → CLAUDE.md (팀 공유 지침)
│   ├─ 조직 전체 규칙? → managed CLAUDE.md
│   ├─ 개인 선호? → CLAUDE.local.md
│   └─ 특정 도메인? → .claude/rules/
└─ 아니오 → 자동 메모리 (발견된 사실)
    └─ 프로젝트 패턴? → memory/에 저장
```

| 질문 | CLAUDE.md | 자동 메모리 |
|------|:---------:|:----------:|
| 팀원 모두에게 필요한가? | O | X |
| 정적이고 변경이 드문가? | O | X |
| 작업 중 발견한 것인가? | X | O |
| 나만 알면 되는가? | X | O |
| 버전 관리해야 하는가? | O | X |

---

## 메모리 파일 조직하기

### 권장 구조

```
~/.claude/projects/<hash>/memory/
├── MEMORY.md                    # 인덱스 (200줄 이내)
├── debugging.md                 # 디버깅 패턴
├── architecture.md              # 아키텍처 메모
├── api-notes.md                 # API 동작 메모
├── testing-notes.md             # 테스트 관련 발견
└── resolved/
    └── old-issues.md            # 해결된 이슈 아카이브
```

### 인덱스 파일 템플릿

```markdown
# 프로젝트 메모리 인덱스

## 빠른 참조
- **언어**: TypeScript + Python
- **프레임워크**: Next.js + FastAPI
- **DB**: PostgreSQL + Redis
- **테스트**: Jest (프론트), pytest (백엔드)

## 주요 발견 사항
- Redis 캐시 무효화는 수동 호출 필요
- DB 마이그레이션은 프론트 배포 전에 실행

## 상세 메모
- @debugging.md — 디버깅 패턴과 해결법
- @architecture.md — 시스템 아키텍처 메모
- @api-notes.md — API 엔드포인트 동작
- @testing-notes.md — 테스트 전략과 팁
```

### 정리 원칙

1. **MEMORY.md는 200줄 이내**로 유지 — 인덱스 역할에 충실
2. **주제별 파일 분리** — 관련 메모끼리 모아두기
3. **해결된 이슈 아카이브** — `resolved/` 폴더로 이동
4. **타임스탬프 기록** — 마지막 리뷰 날짜 표시
5. **주기적 정리** — 오래되거나 부정확한 메모 삭제

---

## 세션 간 학습 흐름

```
세션 1: 버그 수정
  → Claude가 원인 발견
  → debugging.md에 자동 기록

세션 2: 기능 구현
  → MEMORY.md 인덱스 자동 로드 (200줄)
  → 관련 파일 작업 시 debugging.md 참조 가능

세션 3: 유사 버그 발생
  → Claude가 이전 기록을 활용
  → 더 빠르게 원인 파악
```

시간이 지날수록 메모리가 축적되어 Claude의 프로젝트 이해도가 **점진적으로 깊어집니다**.

---

## 사용자에게 메모리 저장 요청하기

Claude에게 직접 메모리에 기록하라고 요청할 수 있습니다:

```
> 이 프로젝트에서 API 응답은 항상 snake_case를 사용한다는 것을
> 기억해줘. 다음 세션에서도 참고할 수 있게.
```

Claude는 이 정보를 적절한 메모리 파일에 기록합니다.

반대로 잊어달라고 요청할 수도 있습니다:

```
> 이전에 저장한 "Python 3.8 사용" 메모를 삭제해줘.
> 이제 Python 3.12를 사용해.
```

---

## 요약

| 주제 | 핵심 포인트 |
|------|------------|
| **자동 메모리** | Claude가 세션 중 자동으로 기록, 다음 세션에 로드 |
| **위치** | `~/.claude/projects/<hash>/memory/` |
| **MEMORY.md** | 인덱스 파일, 처음 200줄만 자동 로드 |
| **`/memory`** | 메모리 파일을 직접 편집하는 커맨드 |
| **저장 대상** | 디버깅 인사이트, 패턴, 아키텍처 메모, API 동작 |
| **저장 금지** | 민감 데이터, 큰 코드, 임시 워크어라운드 |
| **CLAUDE.md와 차이** | CLAUDE.md는 지침 (처방적), 메모리는 발견 (서술적) |
| **정리 원칙** | 200줄 인덱스, 주제별 분리, 주기적 아카이브 |

---

## 다음 파트

Part III의 설정 심화를 모두 배웠습니다. [Part IV: 실전 워크플로우](../04-workflows/01-git-integration.md)에서 Git 워크플로우, Plan 모드, 세션 관리 등 실전 작업 패턴을 다룹니다.
