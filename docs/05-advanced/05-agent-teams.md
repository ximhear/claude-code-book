<!-- last_updated: 2026-02-11 -->

# 23. 에이전트 팀 (실험적 기능)

> 여러 에이전트가 협력하는 팀 기능을 다룹니다.

---

## Agent Teams란?

Agent Teams는 여러 Claude 인스턴스가 **병렬로 협력**하여 복잡한 작업을 수행하는 실험적 기능입니다. 기존 서브에이전트의 순차적 위임과 달리, 팀원들이 동시에 작업하고 직접 소통합니다.

### 서브에이전트 vs 에이전트 팀

| 특성 | 서브에이전트 | 에이전트 팀 |
|------|:----------:|:---------:|
| 실행 방식 | 순차적 | 병렬 |
| 커뮤니케이션 | 부모→자식 | 팀원↔팀원 |
| 조정 | 부모가 관리 | 자율 조정 |
| 태스크 공유 | 없음 | 공유 태스크 리스트 |
| 의사 결정 | 부모가 결정 | 자율적 |

---

## 활성화 방법

Agent Teams는 기본적으로 비활성화되어 있습니다:

```json
{
  "env": {
    "CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS": "true"
  }
}
```

또는 환경 변수로:

```bash
export CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=true
claude
```

---

## 작동 방식

### 팀 구조

```
팀 리더 (Leader)
├── 팀원 A — 독립 컨텍스트, 독립 작업
├── 팀원 B — 독립 컨텍스트, 독립 작업
└── 팀원 C — 독립 컨텍스트, 독립 작업
    ↕ 직접 메시지 교환
    ↕ 공유 태스크 리스트
```

### 워크플로우

1. **리더가 작업을 분할**하고 팀원에게 배분
2. **팀원이 독립적으로 작업** (각자 별도 컨텍스트)
3. **팀원 간 직접 소통**으로 조율
4. **공유 태스크 리스트**로 진행 상황 추적
5. **리더가 결과를 종합**

### 팀 시작

```
> 이 프로젝트를 팀으로 분석해줘.
> 팀원 1은 프론트엔드를, 팀원 2는 백엔드를, 팀원 3은 인프라를 담당해줘.
```

---

## 공유 태스크 리스트

팀원들은 공유 태스크 리스트를 통해 작업을 조율합니다:

```
export CLAUDE_CODE_TASK_LIST_ID=my-project
```

| 기능 | 설명 |
|------|------|
| **태스크 생성** | 리더가 태스크 분배 |
| **상태 업데이트** | 각 팀원이 진행 상황 갱신 |
| **가시성** | 모든 팀원이 전체 진행 상황 확인 |
| **의존성** | 태스크 간 블로킹 관계 설정 |

### Ctrl+T로 태스크 리스트 토글

```
Ctrl+T    # 태스크 리스트 표시/숨기기
```

태스크 상태, 담당자, 진행률을 한눈에 확인합니다.

---

## 실전 사례

### 대규모 코드 분석

```
리더: 프로젝트를 3개 영역으로 나누어 분석
├── 팀원 A: 프론트엔드 아키텍처 분석
├── 팀원 B: 백엔드 API와 데이터 흐름 분석
└── 팀원 C: 인프라와 배포 파이프라인 분석
→ 리더가 결과를 종합하여 전체 아키텍처 문서 생성
```

### 병렬 기능 개발

```
리더: OAuth 통합 프로젝트
├── 팀원 A: 인증 UI 구현
├── 팀원 B: 백엔드 OAuth 핸들러 구현
└── 팀원 C: 테스트와 문서 작성
→ 팀원들이 API 인터페이스를 공유하며 조율
```

### 버그 조사

```
리더: 간헐적 인증 실패 조사
├── 팀원 A: 인증 코드 흐름 분석
├── 팀원 B: 로그와 메트릭 분석
└── 팀원 C: 환경 설정과 의존성 확인
→ 각 팀원이 발견 사항을 공유하며 근본 원인 수렴
```

---

## 비용 관리

Agent Teams는 여러 Claude 인스턴스를 동시에 실행하므로 **비용이 크게 증가**합니다.

### 비용 고려사항

- 팀원 수에 비례하여 API 호출 증가 (3~7배)
- 각 팀원이 독립 컨텍스트를 유지하므로 토큰 소비 증가
- `--max-budget-usd`로 전체 비용 한도 설정 권장

### 비용 절감 전략

| 전략 | 설명 |
|------|------|
| **팀 크기 최소화** | 필요한 만큼만 팀원 배분 |
| **경량 모델 활용** | 탐색 팀원에 Haiku 사용 |
| **명확한 작업 분할** | 중복 작업 방지 |
| **예산 한도 설정** | `--max-budget-usd` 사용 |

---

## 현재 제한사항

Agent Teams는 **실험적 기능**이며 다음 제한이 있습니다:

- 기본적으로 비활성화, 명시적 활성화 필요
- **중첩 팀 불가**: 팀원이 자체 하위 팀을 생성할 수 없음
- 팀 간 파일 충돌 가능 (Git worktree 권장)
- 비용이 크게 증가할 수 있음 (3-7배)
- 복잡한 조율이 필요한 경우 성능 저하 가능
- 안정성이 아직 검증 중

---

## 요약

| 주제 | 핵심 포인트 |
|------|------------|
| **Agent Teams** | 여러 에이전트가 병렬로 협력하는 실험적 기능 |
| **활성화** | `CLAUDE_CODE_EXPERIMENTAL_AGENT_TEAMS=true` |
| **구조** | 리더 + 팀원들, 각자 독립 컨텍스트 |
| **조율** | 직접 메시지, 공유 태스크 리스트 |
| **비용** | 3~7배 증가, 예산 한도 설정 권장 |
| **제한** | 실험적, 파일 충돌 가능, 안정성 검증 중 |

---

## 다음 챕터

[24장: Agent SDK](06-agent-sdk.md)에서 프로그래밍 방식으로 Claude Code를 활용하는 방법을 배웁니다.
